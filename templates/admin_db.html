{% extends "base.html" %}

{% block title %}Raw Database Viewer{% endblock %}

{% block content %}
<div class="dashboard-header" style="margin-bottom: 2rem;">
  <h2>Raw Database Viewer</h2>
  <p>Admin Access Only - Read Only View</p>
  <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">‚Üê Dashboard</a>
</div>

<div style="display: flex; gap: 2rem; align-items: flex-start;">
  <!-- Table List Sidebar -->
  <div class="card" style="width: 250px; flex-shrink: 0; padding: 0; overflow: hidden;">
    <div style="padding: 1rem; background: var(--bg-card); border-bottom: 1px solid var(--border);">
      <h3 style="margin: 0; font-size: 1.1rem;">Tables</h3>
    </div>
    <div style="display: flex; flexDirection: column;">
      {% for table in tables %}
      <a href="{{ url_for('admin_db', table=table) }}"
        style="padding: 10px 1rem; text-decoration: none; color: var(--text); display: block; border-bottom: 1px solid var(--border); transition: background 0.2s; {% if current_table == table %}background: var(--primary); color: white;{% endif %}">
        {{ table }}
      </a>
      {% endfor %}
    </div>
  </div>

  <!-- Data View -->
  <div class="card" style="flex: 1; padding: 0; overflow: hidden; min-height: 400px;">
    {% if current_table %}
    <div
      style="padding: 1rem; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center;">
      <h3 style="margin: 0;">{{ current_table }}</h3>
      <span style="font-size: 0.8rem; color: #888;">Top 100 rows</span>
    </div>
    <div class="table-responsive" style="max-height: 600px; overflow-y: auto;">
      <table class="report-table" style="width: 100%; border-collapse: collapse;">
        <thead>
          <tr>
            {% for col in columns %}
            <th
              style="position: sticky; top: 0; background: var(--bg-card); z-index: 10; padding: 0.75rem; border-bottom: 1px solid var(--border); text-align: left;">
              {{ col }}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody>
          {% for row in data %}
          <tr>
            {% for col in columns %}
            <td style="padding: 0.5rem 0.75rem; border-bottom: 1px solid var(--border);">{{ row[col] }}</td>
            {% endfor %}
          </tr>
          {% else %}
          <tr>
            <td colspan="{{ columns|length }}" style="padding: 2rem; text-align: center; color: #888;">Table {{
              current_table }} is empty.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <div
      style="display: flex; align-items: center; justify-content: center; height: 100%; min-height: 400px; color: #666;">
      <p>Select a table from the sidebar to view raw data.</p>
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}